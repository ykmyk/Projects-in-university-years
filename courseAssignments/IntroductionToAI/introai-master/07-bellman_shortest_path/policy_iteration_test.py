#!/usr/bin/env python3

import sys
sys.path.append("..")
import check_versions
import numpy
from numpy import array
from robot_test import Environment
from robot_control import RobotControl

# Run a single tests to verify the correctness of calculating the probabilities and policies
def evaluate(destination, rotation_probability, energy, expected_iteration):
    env = Environment(destination=array(destination), energy=array(energy), rotation_probability=array(rotation_probability))

    print("Test energy map:")
    print(energy)
    print("Destination", destination)
    print("Probabilities of rotations: forward", env.forward_probability, "right", env.right_probability, "backward", env.backward_probability, "left", env.left_probability)

    robot = RobotControl(env)

    for iter in range(0, len(expected_iteration)-1, 2):
        distance = robot.get_distance_from_policy(expected_iteration[iter])
        for i in range(env.rows):
            for j in range(env.columns):
                if abs(distance[i,j] - expected_iteration[iter+1][i,j]) > 0.0001:
                    print("Incorrect distance")
                    return False

        policy = robot.get_policy_from_distance(expected_iteration[iter+1])
        if not (policy == expected_iteration[iter+2]).all():
            print("Incorrect policy")
            return False
    
    print("Correct")
    return True

def main():
    # destination, rotation_probability, energy, expected_distance, expected_policy
    tests = {
        "1": ((1,1), (1,0,0,0),
array([[ 9., 2., 3. ],
       [ 4., 0., 5. ],
       [ 6., 7., 8. ]]),
[
array([[2, 2, 2],
       [1, 0, 3],
       [0, 0, 0]]),
array([[4., 0., 5.],
       [0., 0., 0.],
       [4., 0., 5.]]),
array([[1, 2, 3],
       [1, 0, 3],
       [0, 0, 0]]),
array([[2., 0., 2.],
       [0., 0., 0.],
       [4., 0., 5.]]),
array([[1, 2, 3],
       [1, 0, 3],
       [0, 0, 0]]),
array([[2., 0., 2.],
       [0., 0., 0.],
       [4., 0., 5.]]),
array([[1, 2, 3],
       [1, 0, 3],
       [0, 0, 0]])
]),
        "2": ((1,1), (0,1,0,0),
array([[ 9., 2., 3. ],
       [ 4., 0., 5. ],
       [ 6., 7., 8. ]]),
[
array([[1, 1, 1],
       [0, 3, 2],
       [3, 3, 3]]),
array([[4., 0., 5.],
       [0., 0., 0.],
       [4., 0., 5.]]),
array([[0, 1, 2],
       [0, 0, 2],
       [3, 3, 3]]),
array([[2., 0., 2.],
       [0., 0., 0.],
       [4., 0., 5.]]),
array([[0, 1, 2],
       [0, 0, 2],
       [3, 3, 1]]),
array([[2., 0., 2.],
       [0., 0., 0.],
       [4., 0., 5.]]),
array([[0, 1, 2],
       [0, 0, 2],
       [3, 3, 1]]),
array([[2., 0., 2.],
       [0., 0., 0.],
       [4., 0., 5.]]),
array([[0, 1, 2],
       [0, 0, 2],
       [3, 3, 1]])
]),
        "3": ((1,1), (1,0,0,0),
array([[ 100., 100., 100., 100., 100. ],
       [ 100., 0., 1., 1., 100. ],
       [ 100., 6., 4., 1., 100. ],
       [ 100., 1., 1., 1., 100. ],
       [ 100., 1., 4., 6., 100. ],
       [ 100., 1., 1., 1., 100. ],
       [ 100., 6., 4., 1., 100. ],
       [ 100., 1., 1., 1., 100. ],
       [ 100., 1., 4., 6., 100. ],
       [ 100., 1., 1., 1., 100. ],
       [ 100., 6., 4., 1., 100. ],
       [ 100., 1., 1., 1., 100. ],
       [ 100., 1., 4., 6., 100. ],
       [ 100., 1., 1., 1., 100. ],
       [ 100., 100., 100., 100., 100. ]]),
[
array([[2, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0]]),
array([[1.000e+02, 0.000e+00, 1.000e+00, 2.000e+00, 1.020e+02],
       [0.000e+00, 0.000e+00, 0.000e+00, 1.000e+00, 2.000e+00],
       [1.000e+02, 0.000e+00, 1.000e+00, 2.000e+00, 1.020e+02],
       [2.000e+02, 6.000e+00, 5.000e+00, 3.000e+00, 2.020e+02],
       [3.000e+02, 7.000e+00, 6.000e+00, 4.000e+00, 3.020e+02],
       [4.000e+02, 8.000e+00, 1.000e+01, 1.000e+01, 4.020e+02],
       [5.000e+02, 9.000e+00, 1.100e+01, 1.100e+01, 5.020e+02],
       [6.000e+02, 1.500e+01, 1.500e+01, 1.200e+01, 6.020e+02],
       [7.000e+02, 1.600e+01, 1.600e+01, 1.300e+01, 7.020e+02],
       [8.000e+02, 1.700e+01, 2.000e+01, 1.900e+01, 8.020e+02],
       [9.000e+02, 1.800e+01, 2.100e+01, 2.000e+01, 9.020e+02],
       [1.000e+03, 2.400e+01, 2.500e+01, 2.100e+01, 1.002e+03],
       [1.100e+03, 2.500e+01, 2.600e+01, 2.200e+01, 1.102e+03],
       [1.200e+03, 2.600e+01, 3.000e+01, 2.800e+01, 1.202e+03],
       [1.300e+03, 2.700e+01, 3.100e+01, 2.900e+01, 1.302e+03]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 0, 3],
       [1, 0, 0, 0, 3]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  7.,   6.,   4.,   3.,   4.],
       [  8.,   7.,   5.,   4.,  10.],
       [  9.,   8.,   9.,  10.,  11.],
       [ 15.,   9.,  10.,  11.,  12.],
       [ 16.,  15.,  13.,  12.,  13.],
       [ 17.,  16.,  14.,  13.,  19.],
       [ 18.,  17.,  18.,  19.,  20.],
       [ 24.,  18.,  19.,  20.,  21.],
       [ 25.,  24.,  22.,  21.,  22.],
       [ 26.,  25.,  23.,  22.,  28.],
       [ 27.,  26.,  27.,  28.,  29.],
       [127.,  27.,  28.,  29., 129.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [0, 0, 0, 0, 0]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  6.,   5.,   4.,   3.,   4.],
       [  7.,   6.,   5.,   4.,  10.],
       [  8.,   7.,   9.,  10.,  11.],
       [ 14.,   8.,  10.,  11.,  12.],
       [ 15.,  14.,  13.,  12.,  13.],
       [ 16.,  15.,  14.,  13.,  19.],
       [ 17.,  16.,  18.,  19.,  20.],
       [ 23.,  17.,  19.,  20.,  21.],
       [ 24.,  23.,  22.,  21.,  22.],
       [ 25.,  24.,  23.,  22.,  28.],
       [ 26.,  25.,  27.,  28.,  29.],
       [126.,  26.,  28.,  29., 129.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 0, 3],
       [0, 0, 0, 0, 0]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  6.,   5.,   4.,   3.,   4.],
       [  7.,   6.,   5.,   4.,  10.],
       [  8.,   7.,   8.,  10.,  11.],
       [ 14.,   8.,   9.,  11.,  12.],
       [ 15.,  14.,  13.,  12.,  13.],
       [ 16.,  15.,  14.,  13.,  19.],
       [ 17.,  16.,  17.,  19.,  20.],
       [ 23.,  17.,  18.,  20.,  21.],
       [ 24.,  23.,  22.,  21.,  22.],
       [ 25.,  24.,  23.,  22.,  28.],
       [ 26.,  25.,  26.,  28.,  29.],
       [126.,  26.,  27.,  29., 129.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [0, 0, 0, 0, 0]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  6.,   5.,   4.,   3.,   4.],
       [  7.,   6.,   5.,   4.,  10.],
       [  8.,   7.,   8.,   9.,  10.],
       [ 14.,   8.,   9.,  10.,  11.],
       [ 15.,  14.,  13.,  11.,  12.],
       [ 16.,  15.,  14.,  12.,  18.],
       [ 17.,  16.,  17.,  18.,  19.],
       [ 23.,  17.,  18.,  19.,  20.],
       [ 24.,  23.,  22.,  20.,  21.],
       [ 25.,  24.,  23.,  21.,  27.],
       [ 26.,  25.,  26.,  27.,  28.],
       [126.,  26.,  27.,  28., 128.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 0, 3],
       [0, 0, 0, 0, 0]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  6.,   5.,   4.,   3.,   4.],
       [  7.,   6.,   5.,   4.,  10.],
       [  8.,   7.,   8.,   9.,  10.],
       [ 14.,   8.,   9.,  10.,  11.],
       [ 15.,  14.,  12.,  11.,  12.],
       [ 16.,  15.,  13.,  12.,  18.],
       [ 17.,  16.,  17.,  18.,  19.],
       [ 23.,  17.,  18.,  19.,  20.],
       [ 24.,  23.,  21.,  20.,  21.],
       [ 25.,  24.,  22.,  21.,  27.],
       [ 26.,  25.,  26.,  27.,  28.],
       [126.,  26.,  27.,  28., 128.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [0, 0, 0, 0, 0]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  6.,   5.,   4.,   3.,   4.],
       [  7.,   6.,   5.,   4.,  10.],
       [  8.,   7.,   8.,   9.,  10.],
       [ 14.,   8.,   9.,  10.,  11.],
       [ 14.,  13.,  12.,  11.,  12.],
       [ 15.,  14.,  13.,  12.,  18.],
       [ 16.,  15.,  17.,  18.,  19.],
       [ 22.,  16.,  18.,  19.,  20.],
       [ 23.,  22.,  21.,  20.,  21.],
       [ 24.,  23.,  22.,  21.,  27.],
       [ 25.,  24.,  26.,  27.,  28.],
       [125.,  25.,  27.,  28., 128.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 0, 3],
       [0, 0, 0, 0, 0]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  6.,   5.,   4.,   3.,   4.],
       [  7.,   6.,   5.,   4.,  10.],
       [  8.,   7.,   8.,   9.,  10.],
       [ 14.,   8.,   9.,  10.,  11.],
       [ 14.,  13.,  12.,  11.,  12.],
       [ 15.,  14.,  13.,  12.,  18.],
       [ 16.,  15.,  16.,  18.,  19.],
       [ 22.,  16.,  17.,  19.,  20.],
       [ 23.,  22.,  21.,  20.,  21.],
       [ 24.,  23.,  22.,  21.,  27.],
       [ 25.,  24.,  25.,  27.,  28.],
       [125.,  25.,  26.,  28., 128.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [0, 0, 0, 0, 0]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  6.,   5.,   4.,   3.,   4.],
       [  7.,   6.,   5.,   4.,  10.],
       [  8.,   7.,   8.,   9.,  10.],
       [ 14.,   8.,   9.,  10.,  11.],
       [ 14.,  13.,  12.,  11.,  12.],
       [ 15.,  14.,  13.,  12.,  18.],
       [ 16.,  15.,  16.,  17.,  18.],
       [ 22.,  16.,  17.,  18.,  19.],
       [ 23.,  22.,  21.,  19.,  20.],
       [ 24.,  23.,  22.,  20.,  26.],
       [ 25.,  24.,  25.,  26.,  27.],
       [125.,  25.,  26.,  27., 127.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 0, 3],
       [0, 0, 0, 0, 0]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  6.,   5.,   4.,   3.,   4.],
       [  7.,   6.,   5.,   4.,  10.],
       [  8.,   7.,   8.,   9.,  10.],
       [ 14.,   8.,   9.,  10.,  11.],
       [ 14.,  13.,  12.,  11.,  12.],
       [ 15.,  14.,  13.,  12.,  18.],
       [ 16.,  15.,  16.,  17.,  18.],
       [ 22.,  16.,  17.,  18.,  19.],
       [ 23.,  22.,  20.,  19.,  20.],
       [ 24.,  23.,  21.,  20.,  26.],
       [ 25.,  24.,  25.,  26.,  27.],
       [125.,  25.,  26.,  27., 127.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 0, 0, 3],
       [0, 0, 0, 0, 0]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  6.,   5.,   4.,   3.,   4.],
       [  7.,   6.,   5.,   4.,  10.],
       [  8.,   7.,   8.,   9.,  10.],
       [ 14.,   8.,   9.,  10.,  11.],
       [ 14.,  13.,  12.,  11.,  12.],
       [ 15.,  14.,  13.,  12.,  18.],
       [ 16.,  15.,  16.,  17.,  18.],
       [ 22.,  16.,  17.,  18.,  19.],
       [ 22.,  21.,  20.,  19.,  20.],
       [ 23.,  22.,  21.,  20.,  26.],
       [ 24.,  23.,  25.,  26.,  27.],
       [124.,  24.,  26.,  27., 127.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 0, 3],
       [0, 0, 0, 0, 0]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  6.,   5.,   4.,   3.,   4.],
       [  7.,   6.,   5.,   4.,  10.],
       [  8.,   7.,   8.,   9.,  10.],
       [ 14.,   8.,   9.,  10.,  11.],
       [ 14.,  13.,  12.,  11.,  12.],
       [ 15.,  14.,  13.,  12.,  18.],
       [ 16.,  15.,  16.,  17.,  18.],
       [ 22.,  16.,  17.,  18.,  19.],
       [ 22.,  21.,  20.,  19.,  20.],
       [ 23.,  22.,  21.,  20.,  26.],
       [ 24.,  23.,  24.,  26.,  27.],
       [124.,  24.,  25.,  27., 127.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [0, 0, 0, 0, 0]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  6.,   5.,   4.,   3.,   4.],
       [  7.,   6.,   5.,   4.,  10.],
       [  8.,   7.,   8.,   9.,  10.],
       [ 14.,   8.,   9.,  10.,  11.],
       [ 14.,  13.,  12.,  11.,  12.],
       [ 15.,  14.,  13.,  12.,  18.],
       [ 16.,  15.,  16.,  17.,  18.],
       [ 22.,  16.,  17.,  18.,  19.],
       [ 22.,  21.,  20.,  19.,  20.],
       [ 23.,  22.,  21.,  20.,  26.],
       [ 24.,  23.,  24.,  25.,  26.],
       [124.,  24.,  25.,  26., 126.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [0, 0, 0, 0, 0]]),
array([[100.,   0.,   1.,   2., 102.],
       [  0.,   0.,   0.,   1.,   2.],
       [  6.,   0.,   1.,   2.,   3.],
       [  6.,   5.,   4.,   3.,   4.],
       [  7.,   6.,   5.,   4.,  10.],
       [  8.,   7.,   8.,   9.,  10.],
       [ 14.,   8.,   9.,  10.,  11.],
       [ 14.,  13.,  12.,  11.,  12.],
       [ 15.,  14.,  13.,  12.,  18.],
       [ 16.,  15.,  16.,  17.,  18.],
       [ 22.,  16.,  17.,  18.,  19.],
       [ 22.,  21.,  20.,  19.,  20.],
       [ 23.,  22.,  21.,  20.,  26.],
       [ 24.,  23.,  24.,  25.,  26.],
       [124.,  24.,  25.,  26., 126.]]),
array([[1, 2, 2, 2, 2],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [1, 0, 0, 0, 3],
       [1, 1, 1, 0, 3],
       [1, 0, 0, 0, 3],
       [1, 0, 3, 3, 3],
       [0, 0, 0, 0, 0]])
]),
        "4": ((1,1), (.4,.2,.2,.2),
array([[ 9., 2., 3. ],
       [ 4., 0., 5. ],
       [ 6., 7., 8. ]]),
[
array([[2, 2, 2],
       [1, 0, 3],
       [0, 0, 0]]),
array([[25.324634, 17.672619, 26.544414],
       [17.987179,  0.      , 17.179487],
       [27.431777, 17.494048, 26.365842]]),
array([[1, 2, 3],
       [1, 0, 3],
       [0, 0, 0]]),
array([[24.240741, 17.166667, 25.425926],
       [17.574074,  0.      , 16.759259],
       [26.87037 , 17.166667, 25.796296]]),
array([[1, 2, 3],
       [1, 0, 3],
       [0, 0, 0]]),
array([[24.240741, 17.166667, 25.425926],
       [17.574074,  0.      , 16.759259],
       [26.87037 , 17.166667, 25.796296]]),
array([[1, 2, 3],
       [1, 0, 3],
       [0, 0, 0]])
]),
       "17": ((6, 5), (0.6, 0.129096, 0.048828, 0.222076),
array([[1.864041e+00, 4.432889e+00, 6.311956e+00, 2.654280e+00, 1.912010e+00, 5.833797e+00, 2.794818e+00, 3.422686e+00, 1.748296e-01, 2.970219e+00, 1.388945e+00],
       [2.906939e+00, 1.297296e+00, 8.559583e+00, 8.003398e-01, 9.873536e-01, 5.105444e+00, 1.049587e+01, 1.345850e+00, 5.592108e+00, 3.226013e+00, 1.908344e-01],
       [6.713173e+00, 1.752331e+00, 4.390865e+00, 2.050603e+00, 8.711304e+00, 7.706095e-01, 8.218498e-01, 2.234567e+00, 8.338580e-01, 3.293815e+00, 5.430058e-01],
       [9.646865e+00, 1.796218e+00, 3.357212e+00, 4.177859e+00, 7.938566e+00, 2.848659e-01, 1.532829e+00, 9.413375e+00, 1.940443e+00, 2.902589e+00, 5.075948e+00],
       [4.755532e+00, 4.019696e+00, 1.062740e+00, 1.915935e+00, 5.316311e+00, 6.777291e+00, 6.280372e+00, 1.146492e+01, 2.866536e-01, 9.511573e-01, 3.748847e+00],
       [5.728955e-01, 3.756583e+00, 1.870234e+00, 2.215651e+00, 1.042448e+01, 2.264138e+01, 3.547671e+00, 4.154724e+00, 4.400122e+00, 1.308252e+01, 7.680946e+00],
       [1.455629e+00, 2.480491e+00, 8.465064e+00, 3.871816e+00, 3.503526e+00, 0.000000e+00, 6.865094e+00, 3.033251e+00, 1.160614e+01, 1.224659e-02, 4.011425e+00],
       [2.015195e+00, 7.238840e+00, 1.010192e+01, 3.995933e+00, 4.015114e+00, 4.628188e+00, 6.527245e+00, 7.865932e+00, 4.254089e-01, 3.389442e+00, 2.805231e+00],
       [6.744596e-01, 5.392216e+00, 2.328087e+00, 7.018923e+00, 1.066962e+01, 2.481954e+00, 6.866165e-01, 4.570490e+00, 2.580088e+01, 5.010473e+00, 3.058032e+00],
       [9.244201e+00, 1.069470e+01, 2.999845e+00, 2.112717e+01, 8.747328e+00, 1.316188e+00, 3.990755e+00, 3.382583e+01, 2.060988e+00, 7.039835e+00, 1.390385e+00],
       [2.782159e+00, 1.511451e+01, 4.882823e-01, 5.621786e-01, 1.515415e+01, 2.322636e+00, 8.566184e+00, 6.364302e+00, 2.505558e+00, 1.850263e+00, 7.950014e-01],
       [1.416677e+00, 6.697207e+00, 1.991169e+00, 1.005210e+01, 8.390594e+00, 8.310030e+00, 2.817146e+00, 1.003625e+01, 2.739339e+00, 6.338128e+00, 1.037500e+01],
       [2.852662e+00, 6.481832e+00, 2.182930e-01, 1.160502e+00, 1.391117e+00, 1.491163e-01, 4.306796e+00, 5.316608e+00, 5.845711e+00, 1.374475e+01, 4.621907e+00]]),
[
array([[2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [1, 1, 1, 1, 1, 0, 3, 3, 3, 3, 3],
       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
       [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]),
array([[ 89.869228,  82.359954,  78.521332,  72.137545,  73.843493,  75.417932,  82.879312,  85.975713,  91.710972,  93.58638 ,  91.854043],
       [ 85.9893  ,  75.545974,  67.723827,  64.924902,  68.006353,  65.658666,  69.913799,  80.991466,  83.385029,  88.764672,  89.050163],
       [ 81.494237,  69.732984,  60.718185,  58.121459,  58.134508,  57.441787,  63.028145,  75.242213,  78.899621,  84.614736,  87.590234],
       [ 73.521119,  65.094615,  53.979753,  48.592239,  48.844991,  51.677531,  55.76914 ,  66.04025 ,  73.110763,  80.859851,  82.083024],
       [ 67.090141,  59.537491,  49.681089,  40.820597,  40.065412,  41.188066,  42.364453,  52.189559,  67.838593,  78.253387,  77.078895],
       [ 63.560689,  55.789034,  46.772604,  33.809219,  24.781711,  14.007618,  28.51607 ,  41.006068,  59.544921,  65.948873,  70.057232],
       [ 59.866485,  53.525955,  39.214142,  25.50224 ,  12.790279,   0.      ,  12.102363,  29.563393,  43.122941,  60.925488,  65.430922],
       [ 64.829292,  60.157074,  52.275065,  37.814949,  23.387381,  11.193914,  22.163081,  35.725136,  55.116107,  61.879527,  68.514307],
       [ 70.946811,  69.483478,  65.315662,  50.336114,  36.093185,  26.285778,  32.930682,  49.200487,  59.645281,  72.309534,  73.227532],
       [ 77.443217,  79.581921,  75.993163,  64.697355,  56.803418,  41.031675,  44.879683,  59.348037,  87.998492,  81.525133,  80.916307],
       [ 90.151473,  91.537984,  87.146678,  87.083078,  71.255871,  57.168028,  58.536424,  87.970527,  91.82008 ,  90.465938,  86.978735],
       [ 98.488536, 104.312031,  95.314927,  91.765582,  89.534956,  71.706351,  75.508076,  92.103207,  97.96597 ,  97.050468,  93.994347],
       [104.044625, 107.636235, 100.895988,  99.750498,  95.845812,  84.916116,  83.573072,  99.285359, 103.534363, 105.507523, 107.457557]]),
array([[2, 2, 2, 2, 2, 2, 3, 2, 2, 2, 2],
       [1, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2],
       [1, 1, 2, 2, 2, 2, 3, 3, 2, 3, 2],
       [1, 1, 2, 2, 2, 2, 3, 3, 2, 3, 2],
       [2, 1, 1, 2, 2, 2, 2, 2, 3, 3, 1],
       [1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 1],
       [1, 1, 1, 1, 1, 0, 3, 3, 3, 3, 3],
       [0, 0, 1, 1, 1, 0, 3, 0, 0, 3, 3],
       [0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1],
       [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
       [0, 1, 0, 0, 1, 0, 0, 3, 0, 1, 0],
       [0, 1, 0, 0, 1, 0, 0, 3, 0, 0, 0],
       [2, 2, 2, 2, 2, 2, 0, 3, 2, 2, 2]]),
array([[75.072036, 71.598886, 70.449792, 65.39465 , 67.3734  , 69.345968, 74.843541, 72.090933, 75.976886, 76.768957, 75.965805],
       [70.647698, 66.191918, 61.022645, 60.137312, 62.900823, 60.706987, 61.928882, 67.109886, 68.094759, 71.825678, 73.731105],
       [66.558292, 60.799813, 53.991043, 54.022398, 55.141943, 53.737061, 56.577248, 60.613561, 63.952612, 66.711527, 72.674385],
       [60.976761, 54.016775, 46.752426, 44.705124, 46.526043, 48.937485, 50.04479 , 54.408681, 59.21736 , 62.731306, 67.850187],
       [54.551447, 47.192212, 42.005231, 37.08899 , 38.29455 , 39.540493, 38.682084, 44.202752, 55.111815, 59.561359, 63.114891],
       [51.257537, 43.191905, 36.655766, 30.213188, 23.431694, 13.228609, 26.155258, 34.144117, 44.507816, 52.590409, 57.238604],
       [50.814741, 45.333489, 32.912658, 22.48895 , 11.746417,  0.      , 11.174749, 27.351883, 38.692466, 55.211327, 58.615112],
       [56.531384, 51.077959, 37.969573, 27.894494, 18.763511,  9.725981, 19.844694, 33.236076, 51.138513, 57.383097, 62.703228],
       [62.667069, 59.774149, 50.336787, 39.659448, 29.666388, 23.381967, 30.36758 , 46.460158, 55.834413, 67.563575, 65.819997],
       [69.199458, 69.558669, 62.628032, 53.05916 , 44.005956, 35.605935, 41.327676, 55.544442, 83.839705, 76.49696 , 73.930135],
       [81.334992, 78.399454, 73.84615 , 74.548884, 56.673428, 49.326329, 52.019877, 70.896326, 84.069163, 83.192554, 79.589987],
       [87.567946, 85.243484, 80.045339, 77.122063, 71.404964, 61.33149 , 66.503428, 74.529726, 87.215783, 88.03175 , 84.908813],
       [80.464953, 78.024509, 77.053421, 71.252828, 71.518429, 75.06232 , 72.881526, 78.307987, 82.384449, 83.093676, 82.069664]]),
array([[2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [1, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2],
       [1, 2, 2, 2, 2, 2, 2, 3, 2, 3, 3],
       [2, 1, 2, 2, 2, 2, 3, 3, 2, 3, 3],
       [2, 1, 2, 2, 2, 2, 2, 2, 2, 3, 3],
       [1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 1],
       [1, 1, 1, 1, 1, 0, 3, 3, 3, 3, 1],
       [0, 1, 1, 1, 1, 0, 3, 0, 0, 0, 1],
       [0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1],
       [0, 0, 0, 0, 1, 0, 0, 3, 1, 1, 0],
       [0, 1, 0, 1, 1, 0, 0, 3, 3, 1, 0],
       [2, 2, 0, 2, 1, 0, 0, 3, 3, 0, 0],
       [2, 2, 1, 2, 2, 0, 0, 3, 2, 2, 2]]),
array([[71.701469, 68.629551, 68.646316, 64.342461, 66.306145, 67.673494, 71.699797, 69.691625, 73.04884 , 73.371377, 72.057239],
       [67.24378 , 62.884399, 59.297564, 59.296985, 62.120531, 59.677744, 59.97922 , 65.015956, 65.222139, 68.512149, 69.492755],
       [62.964576, 56.899811, 52.285347, 53.367457, 54.745402, 53.047272, 54.58012 , 58.801656, 61.080152, 63.652272, 67.901368],
       [58.926117, 51.844452, 45.131522, 44.195709, 46.324868, 48.696107, 49.528186, 53.494336, 56.185861, 59.691993, 63.979771],
       [53.072418, 45.383048, 40.09848 , 36.716478, 38.190475, 39.428824, 38.36998 , 43.201068, 51.614739, 56.695261, 60.368145],
       [50.21998 , 42.336148, 36.086172, 30.082568, 23.396089, 13.200049, 26.071903, 33.910567, 43.795714, 51.503526, 55.549002],
       [49.93829 , 44.856575, 32.711315, 22.437297, 11.734219,  0.      , 11.153811, 27.264287, 38.388771, 54.278675, 55.485574],
       [54.927336, 50.123093, 37.810224, 27.851917, 18.749817,  9.718415, 19.818125, 33.100744, 50.626668, 55.323833, 58.826822],
       [60.740878, 57.220028, 50.007846, 39.54241 , 29.632564, 23.359532, 30.31031 , 46.239048, 55.143606, 65.756044, 63.416498],
       [67.145813, 67.394254, 61.864123, 52.770887, 43.916049, 35.544693, 41.167899, 54.765953, 81.76604 , 74.279388, 71.616592],
       [79.190092, 76.817177, 72.849486, 73.795265, 56.428841, 49.179126, 51.788134, 70.268684, 80.168722, 80.774693, 77.25817 ],
       [83.664305, 82.153665, 78.209448, 74.021373, 70.634212, 60.794412, 66.049576, 73.639738, 84.315476, 85.430188, 82.249614],
       [77.101756, 74.969132, 73.952089, 69.652091, 69.637754, 70.577189, 71.230032, 76.529157, 79.512909, 79.745918, 78.415613]]),
array([[2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [1, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2],
       [1, 2, 2, 2, 2, 2, 2, 3, 2, 3, 3],
       [1, 1, 2, 2, 2, 2, 3, 3, 2, 3, 3],
       [2, 1, 2, 2, 2, 2, 2, 2, 2, 3, 3],
       [1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 1],
       [1, 1, 1, 1, 1, 0, 3, 3, 3, 3, 1],
       [0, 1, 1, 1, 1, 0, 3, 0, 0, 0, 1],
       [0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1],
       [0, 0, 0, 0, 1, 0, 0, 3, 1, 1, 0],
       [0, 1, 0, 1, 1, 0, 0, 3, 3, 1, 0],
       [2, 2, 0, 2, 1, 0, 0, 3, 0, 0, 0],
       [2, 2, 1, 2, 2, 0, 0, 3, 2, 2, 2]]),
array([[71.666332, 68.601448, 68.634009, 64.337611, 66.303373, 67.672444, 71.698819, 69.689585, 73.043764, 73.360537, 72.034619],
       [67.202965, 62.851564, 59.285441, 59.292947, 62.117555, 59.677064, 59.97874 , 65.01494 , 65.219266, 68.504808, 69.47228 ],
       [62.869208, 56.860642, 52.274705, 53.364831, 54.744672, 53.04704 , 54.579923, 58.801295, 61.078713, 63.649117, 67.88577 ],
       [58.445538, 51.8063  , 45.124171, 44.194222, 46.324544, 48.696006, 49.52808 , 53.494152, 56.184942, 59.68937 , 63.950931],
       [53.038715, 45.370839, 40.095852, 36.715915, 38.190351, 39.428785, 38.369929, 43.200937, 51.614334, 56.694107, 60.360101],
       [50.209168, 42.332165, 36.085226, 30.082362, 23.396044, 13.200037, 26.071884, 33.910525, 43.795569, 51.502716, 55.540071],
       [49.93441 , 44.855214, 32.710972, 22.437219, 11.734204,  0.      , 11.153802, 27.264255, 38.388648, 54.278053, 55.480781],
       [54.92401 , 50.122465, 37.810068, 27.851872, 18.749801,  9.718407, 19.818101, 33.100677, 50.626422, 55.32289 , 58.823328],
       [60.738006, 57.219491, 50.007677, 39.54233 , 29.632524, 23.359505, 30.310245, 46.238818, 55.142871, 65.75472 , 63.413494],
       [67.142942, 67.393047, 61.863651, 52.770676, 43.915917, 35.544591, 41.167578, 54.764318, 81.758574, 74.275157, 71.613179],
       [79.185298, 76.813355, 72.847959, 73.794421, 56.428446, 49.178814, 51.78716 , 70.263963, 80.132438, 80.762877, 77.252032],
       [83.639431, 82.135045, 78.203581, 74.017612, 70.633148, 60.79365 , 66.047469, 73.63004 , 84.171781, 85.38819 , 82.232262],
       [77.071315, 74.945932, 73.945339, 69.647549, 69.635151, 70.575834, 71.22795 , 76.52552 , 79.498933, 79.730411, 78.392432]]),
array([[2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [1, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2],
       [1, 2, 2, 2, 2, 2, 2, 3, 2, 3, 3],
       [1, 1, 2, 2, 2, 2, 3, 3, 2, 3, 3],
       [2, 1, 2, 2, 2, 2, 2, 2, 2, 3, 3],
       [1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 1],
       [1, 1, 1, 1, 1, 0, 3, 3, 3, 3, 1],
       [0, 1, 1, 1, 1, 0, 3, 0, 0, 0, 1],
       [0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1],
       [0, 0, 0, 0, 1, 0, 0, 3, 1, 1, 0],
       [0, 1, 0, 1, 1, 0, 0, 3, 3, 1, 0],
       [2, 2, 0, 2, 1, 0, 0, 3, 0, 0, 0],
       [2, 2, 1, 2, 2, 0, 0, 3, 2, 2, 2]]),
array([[71.666332, 68.601448, 68.634009, 64.337611, 66.303373, 67.672444, 71.698819, 69.689585, 73.043764, 73.360537, 72.034619],
       [67.202965, 62.851564, 59.285441, 59.292947, 62.117555, 59.677064, 59.97874 , 65.01494 , 65.219266, 68.504808, 69.47228 ],
       [62.869208, 56.860642, 52.274705, 53.364831, 54.744672, 53.04704 , 54.579923, 58.801295, 61.078713, 63.649117, 67.88577 ],
       [58.445538, 51.8063  , 45.124171, 44.194222, 46.324544, 48.696006, 49.52808 , 53.494152, 56.184942, 59.68937 , 63.950931],
       [53.038715, 45.370839, 40.095852, 36.715915, 38.190351, 39.428785, 38.369929, 43.200937, 51.614334, 56.694107, 60.360101],
       [50.209168, 42.332165, 36.085226, 30.082362, 23.396044, 13.200037, 26.071884, 33.910525, 43.795569, 51.502716, 55.540071],
       [49.93441 , 44.855214, 32.710972, 22.437219, 11.734204,  0.      , 11.153802, 27.264255, 38.388648, 54.278053, 55.480781],
       [54.92401 , 50.122465, 37.810068, 27.851872, 18.749801,  9.718407, 19.818101, 33.100677, 50.626422, 55.32289 , 58.823328],
       [60.738006, 57.219491, 50.007677, 39.54233 , 29.632524, 23.359505, 30.310245, 46.238818, 55.142871, 65.75472 , 63.413494],
       [67.142942, 67.393047, 61.863651, 52.770676, 43.915917, 35.544591, 41.167578, 54.764318, 81.758574, 74.275157, 71.613179],
       [79.185298, 76.813355, 72.847959, 73.794421, 56.428446, 49.178814, 51.78716 , 70.263963, 80.132438, 80.762877, 77.252032],
       [83.639431, 82.135045, 78.203581, 74.017612, 70.633148, 60.79365 , 66.047469, 73.63004 , 84.171781, 85.38819 , 82.232262],
       [77.071315, 74.945932, 73.945339, 69.647549, 69.635151, 70.575834, 71.22795 , 76.52552 , 79.498933, 79.730411, 78.392432]]),
array([[2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2],
       [1, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2],
       [1, 2, 2, 2, 2, 2, 2, 3, 2, 3, 3],
       [1, 1, 2, 2, 2, 2, 3, 3, 2, 3, 3],
       [2, 1, 2, 2, 2, 2, 2, 2, 2, 3, 3],
       [1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 1],
       [1, 1, 1, 1, 1, 0, 3, 3, 3, 3, 1],
       [0, 1, 1, 1, 1, 0, 3, 0, 0, 0, 1],
       [0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1],
       [0, 0, 0, 0, 1, 0, 0, 3, 1, 1, 0],
       [0, 1, 0, 1, 1, 0, 0, 3, 3, 1, 0],
       [2, 2, 0, 2, 1, 0, 0, 3, 0, 0, 0],
       [2, 2, 1, 2, 2, 0, 0, 3, 2, 2, 2]])
])}

    if len(sys.argv) == 1:
        correct = True
        for name in tests:
            print("Running test", name)
            correct = evaluate(*tests[name]) and correct
            print()
        print("All tests passed." if correct else "Some tests failed.")
    else:
        name = sys.argv[1]
        if name in tests:
            evaluate(*tests[name])
        else:
            print("Unknown test", name)

"""
To run all tests, run the command
$ python3 probability_test.py

To run a test NAME, run the command
$ python3 probability_test.py NAME
"""
if __name__ == "__main__":
    main()
